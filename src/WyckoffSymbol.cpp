#include "WyckoffSymbol.h"

#include <limits>
#include <regex>

#include "ArgumentOutOfRangeException.h"

using namespace ChemToolkit::Crystallography::Symmetry;


// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// Constructors

WyckoffSymbol::WyckoffSymbol() noexcept
	: _symbol{}
{
}

WyckoffSymbol::WyckoffSymbol(const std::string& symbol)
	: _symbol{ symbol }
{
	if (!(isValidSymbol(_symbol)))
		throw System::ExceptionServices::ArgumentOutOfRangeException{ typeid(*this), "constructor", "Site symmetry symbol is invalid." };
}

WyckoffSymbol::WyckoffSymbol(const size_type num)
	: _symbol{ toSymbol(num) }
{
}

WyckoffSymbol::WyckoffSymbol(const std::size_t num)
	: _symbol{}
{
	if (std::numeric_limits<size_type>::max() < num)
		throw System::ExceptionServices::ArgumentOutOfRangeException{ typeid(*this), "constructor", "Argument value is too large." };
	else
		_symbol = toSymbol(static_cast<size_type>(num));
}

WyckoffSymbol::WyckoffSymbol(const int num)
	: _symbol{}
{
	if (std::numeric_limits<size_type>::max() < num)
		throw System::ExceptionServices::ArgumentOutOfRangeException{ typeid(*this), "constructor", "Argument value is too large." };
	else
	{
		if (num < 0)
			throw System::ExceptionServices::ArgumentOutOfRangeException{ typeid(*this), "constructor", "Argument number is not more than zero." };
		else
			_symbol = toSymbol(static_cast<size_type>(num));
	}
}

// Constructors
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// Private methods

bool WyckoffSymbol::isValidSymbol(const std::string& symbol) noexcept
{
	std::regex pat("[[:alpha:]]{1}");
	std::smatch sm;

	return std::regex_match(symbol, sm, pat);
}

std::string WyckoffSymbol::toSymbol(const size_type number)
{
	switch (number)
	{
	case 0:
		return std::string{ "a" };
	case 1:
		return std::string{ "b" };
	case 2:
		return std::string{ "c" };
	case 3:
		return std::string{ "d" };
	case 4:
		return std::string{ "e" };
	case 5:
		return std::string{ "f" };
	case 6:
		return std::string{ "g" };
	case 7:
		return std::string{ "h" };
	case 8:
		return std::string{ "i" };
	case 9:
		return std::string{ "j" };
	case 10:
		return std::string{ "k" };
	case 11:
		return std::string{ "l" };
	case 12:
		return std::string{ "m" };
	case 13:
		return std::string{ "n" };
	case 14:
		return std::string{ "o" };
	case 15:
		return std::string{ "p" };
	case 16:
		return std::string{ "q" };
	case 17:
		return std::string{ "r" };
	case 18:
		return std::string{ "s" };
	case 19:
		return std::string{ "t" };
	case 20:
		return std::string{ "u" };
	case 21:
		return std::string{ "v" };
	case 22:
		return std::string{ "w" };
	case 23:
		return std::string{ "x" };
	case 24:
		return std::string{ "y" };
	case 25:
		return std::string{ "z" };

	default:
		throw System::ExceptionServices::ArgumentOutOfRangeException{ "ChemToolkit::Crystallography::Symmetry::WyckoffSymbol::toSpaceGroupSymbol", "Argument number does not correspond to any wyckoff symbol." };
	}
}

// Private methods
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
