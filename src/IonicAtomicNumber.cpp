#include "IonicAtomicNumber.h"

#include <regex>

using namespace ChemToolkit::Generic;


// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// Methods

IonicAtomicNumber IonicAtomicNumber::toIonicAtomicNumber(const std::string& texts)
{
	using ChemToolkit::Generic::ElementSymbol;

	std::regex elementPat("([[:alpha:]]+)");
	std::regex anionPatA("([[:alpha:]]+)[\\-]{1}");
	std::regex anionPatB("([[:alpha:]]+)([\\d]+)[\\-]{1}");
	std::regex cationPatA("([[:alpha:]]+)[\\+]{1}");
	std::regex cationPatB("([[:alpha:]]+)([\\d]+)[\\+]{1}");
	std::smatch sm;


	if (std::regex_match(texts, sm, elementPat))
		return IonicAtomicNumber{ AtomicNumber{ ElementSymbol{ sm.str(1) } }, FormalCharge{ 0 } };

	else if (std::regex_match(texts, sm, anionPatA))
		return IonicAtomicNumber{ AtomicNumber{ ElementSymbol{ sm.str(1) } }, FormalCharge{ -1 } };

	else if (std::regex_match(texts, sm, anionPatB))
		return IonicAtomicNumber{ AtomicNumber{ ElementSymbol{ sm.str(1) } }, FormalCharge{ ((-1) * std::stoi(sm.str(2))) } };

	else if (std::regex_match(texts, sm, cationPatA))
		return IonicAtomicNumber{ AtomicNumber{ ElementSymbol{ sm.str(1) } }, FormalCharge{ 1 } };

	else if (std::regex_match(texts, sm, cationPatB))
		return IonicAtomicNumber{ AtomicNumber{ ElementSymbol{ sm.str(1) } }, FormalCharge{ std::stoi(sm.str(2)) } };

	else
		throw System::ExceptionServices::ArgumentOutOfRangeException{ "MathematicalCrystalChemistry::CrystalModel::Generic::IonicAtomicNumber::toIonicAtomicNumber", "Invalid ionized atomic number texts." };
}

// Methods
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
