#include "AtomSite.h"

#include <regex>

using namespace ChemToolkit::Crystallography;


// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// Constructor

AtomSite::AtomSite() noexcept
	: _atomicNumber{}
	, _formalCharge{ 0 }
	, _fractionalCoordinate{}
	, _siteSymmetrySymbol{}
	, _wyckoffSymbol{}
	, _siteIndex{ 0 }
	, _siteOccupancy{ 0.0 }
	, _siteMultiplicity{ 0 }
{
}

// Constructor
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// Property

void AtomSite::setSiteLabel(const std::string& label)
{
	std::regex siteLabelPat{ "([[:alpha:]]+)+([\\d]+)" };;
	std::smatch siteLabelSm;


	if (std::regex_match(label, siteLabelSm, siteLabelPat))
	{
		_atomicNumber = ChemToolkit::Generic::ElementSymbol{ siteLabelSm.str(1) }.toAtomicNumber();
		_siteIndex = static_cast<size_type>(std::stoi(siteLabelSm.str(2)));
	}
}

// Property
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
