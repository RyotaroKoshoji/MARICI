#include "NumericalMatrix.h"

#include <memory>
#include <mkl.h>

#include "ApplicationException.h"
#include "InvalidOperationException.h"

using namespace MathToolkit::LinearAlgebra;


// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// Access methods

template <>
NumericalMatrix<double, 0, 0>& NumericalMatrix<double, 0, 0>::invert()
{
	if (isSquareMatrix())
	{
		NumericalMatrix<double, 0, 0> inverseMatrix = getIdentityMatrix<double>(columnSize());
		std::unique_ptr<lapack_int[]> ipiv{ new lapack_int[columnSize()] };
		const lapack_int n = static_cast<lapack_int>(columnSize());
		{
			lapack_int info = LAPACKE_dgesv(LAPACK_COL_MAJOR, n, n, begin(), n, ipiv.get(), inverseMatrix.begin(), n);

			if (info != 0)
				throw System::ExceptionServices::ApplicationException{ typeid(*this), "invert", "Could not find inverse matrix." };
		}

		this->swap(inverseMatrix);
		return *this;
	}

	else
		throw System::ExceptionServices::InvalidOperationException{ typeid(*this), "invert", "This is not a square matrix." };
}

template <>
void NumericalMatrix<double, 0, 0>::getSingularValueDecomposition() const
{
}

// Customize methods
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
