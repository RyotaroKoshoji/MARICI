#ifndef SYSTEM_IO_DIRECTORY_H
#define SYSTEM_IO_DIRECTORY_H

#include <vector>
#include <string>
#include <filesystem>

#include "ArgumentOutOfRangeException.h"
#include "DirectoryNotFoundException.h"
#include "FileNotFoundException.h"


namespace System
{
	namespace IO
	{
		class Directory final
		{
		public:
			enum class SearchOptions
			{
				TopDirectoryOnly,
				AllDirectories
			};

			enum class CopyOptions
			{
				none,
				skip_existing,
				overwrite_existing,
				recursive,
				directories_only
			};

			enum class CreateOptions
			{
				none,
				skip_existing,
				overwrite_existing,
			};

// **********************************************************************************************************************************************************************************************************************************************************************************************
		// Destructor

		public:
			virtual ~Directory() = default;

		// Destructor
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
		// Methods

			static bool exist(const std::filesystem::path&);
			static void copy(const std::filesystem::path& sourceDirectoryPath, const std::filesystem::path& destinationDirectoryPath, const CopyOptions& copyOption = CopyOptions::none);
			static void move(const std::filesystem::path& sourceDirectoryPath, const std::filesystem::path& destinationDirectoryPath, const CreateOptions& createOption = CreateOptions::none);

			static void createDirectory(const std::filesystem::path&, const CreateOptions& createOption = CreateOptions::none);
			static void createDirectories(const std::filesystem::path&, const CreateOptions& createOption = CreateOptions::none);
			static void deleteDirectory(const std::filesystem::path&);


			static std::size_t countDirectories(const std::filesystem::path& directoryPath, const SearchOptions& searchOption = SearchOptions::TopDirectoryOnly);
			static std::size_t countDirectories(const std::filesystem::path& directoryPath, const std::string& directoryNamePattern, const SearchOptions& searchOption = SearchOptions::TopDirectoryOnly);

			static std::vector<std::filesystem::path> enumerateDirectories(const std::filesystem::path& directoryPath, const SearchOptions& searchOption = SearchOptions::TopDirectoryOnly);
			static std::vector<std::filesystem::path> enumerateDirectories(const std::filesystem::path& directoryPath, const std::string& directoryNamePattern, const SearchOptions& searchOption = SearchOptions::TopDirectoryOnly);

			static std::vector<std::filesystem::path> enumerateFiles(const std::filesystem::path& directoryPath, const SearchOptions& searchOption = SearchOptions::TopDirectoryOnly);
			static std::vector<std::filesystem::path> enumerateFiles(const std::filesystem::path& directoryPath, const std::string& fileNamePattern, const SearchOptions& searchOption = SearchOptions::TopDirectoryOnly);

		// Methods
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
		// Utility

			static std::string getDirectoryName(const std::filesystem::path&);
			static void normalize(std::filesystem::path&);

		// Utility
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
		// Private methods

		private:
			static void validateDirectory(const std::filesystem::path&);
			static void validateCreatingDirectoryPath(const std::filesystem::path&);

		// Private methods
// **********************************************************************************************************************************************************************************************************************************************************************************************

		private:
			Directory() noexcept = delete;
			Directory(const Directory&) = delete;
			Directory(Directory&&) noexcept = delete;
			Directory& operator=(const Directory&) = delete;
			Directory& operator=(Directory&&) noexcept = delete;
		};
	}
}

// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// Methods

inline bool System::IO::Directory::exist(const std::filesystem::path& directoryPath)
{
	return std::filesystem::is_directory(directoryPath);
}

inline void System::IO::Directory::deleteDirectory(const std::filesystem::path& directoryPath)
{
	std::filesystem::remove_all(directoryPath);
}

// Methods
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// Utility

inline std::string System::IO::Directory::getDirectoryName(const std::filesystem::path& directoryPath)
{
	std::string directoryPathName = directoryPath.generic_string();
	{
		if (directoryPathName.back() == '/')
			directoryPathName.pop_back();
	}

	return std::filesystem::path{ directoryPathName }.filename().generic_string();
}

inline void System::IO::Directory::normalize(std::filesystem::path& directoryPath)
{
	std::string directoryPathName = directoryPath.generic_string();
	{
		if (directoryPathName.back() == '/')
			directoryPathName.pop_back();
	}

	directoryPath = std::filesystem::path{ directoryPathName };
}

inline std::size_t System::IO::Directory::countDirectories(const std::filesystem::path& directoryPath, const SearchOptions& searchOption)
{
	std::string directoryNamePattern{ "([\\#\\-\\_\\+\\.\\:[:alnum:]]+)" };
	return countDirectories(directoryPath, directoryNamePattern, searchOption);
}

inline std::vector<std::filesystem::path> System::IO::Directory::enumerateDirectories(const std::filesystem::path& directoryPath, const SearchOptions& searchOption)
{
	std::string directoryNamePattern{ "([\\#\\-\\_\\+\\.\\:[:alnum:]]+)" };
	return enumerateDirectories(directoryPath, directoryNamePattern, searchOption);
}

inline std::vector<std::filesystem::path> System::IO::Directory::enumerateFiles(const std::filesystem::path& directoryPath, const SearchOptions& searchOption)
{
	std::string fileNamePattern{ "([\\#\\-\\_\\+\\.\\:[:alnum:]]+)[\\.[:alnum:]]*" };
	return enumerateFiles(directoryPath, fileNamePattern, searchOption);
}

// Utility
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************


#endif // !SYSTEM_IO_DIRECTORY_H
