#ifndef CHEMTOOLKIT_CRYSTALLOGRAPHY_SYMMETRY_SPACEGROUPSYMBOL_H
#define CHEMTOOLKIT_CRYSTALLOGRAPHY_SYMMETRY_SPACEGROUPSYMBOL_H

#include <string>

#include "ArgumentOutOfRangeException.h"


namespace ChemToolkit
{
	namespace Crystallography
	{
		namespace Symmetry
		{
			class SpaceGroupNumber;


			class SpaceGroupSymbol
			{
				using size_type = unsigned short;

// **********************************************************************************************************************************************************************************************************************************************************************************************
			// Constructors, destructor, and operators

			public:
				SpaceGroupSymbol() noexcept;
				SpaceGroupSymbol(const std::string&);

				explicit SpaceGroupSymbol(const size_type);
				explicit SpaceGroupSymbol(const std::size_t);
				explicit SpaceGroupSymbol(const int);
				explicit SpaceGroupSymbol(const SpaceGroupNumber);

				virtual ~SpaceGroupSymbol() = default;

				SpaceGroupSymbol(const SpaceGroupSymbol&) = default;
				SpaceGroupSymbol(SpaceGroupSymbol&&) noexcept = default;
				SpaceGroupSymbol& operator=(const SpaceGroupSymbol&) = default;
				SpaceGroupSymbol& operator=(SpaceGroupSymbol&&) noexcept = default;

			// Constructors, destructor, and operators
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
			// Property

				operator std::string() const noexcept;

				void set() noexcept;
				void set(const std::string&);

			// Property
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
			// Methods

				SpaceGroupNumber toSpaceGroupNumber() const;
				std::size_t getHashCode() const noexcept;

			// Methods
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
			// Private methods

			private:
				static size_type getSpaceGroupNumber(const std::string&) noexcept;
				static bool isValidSymbol(const std::string&) noexcept;

			// Private methods
// **********************************************************************************************************************************************************************************************************************************************************************************************

			private:
				std::string _symbol;


				friend bool operator<(const SpaceGroupSymbol&, const SpaceGroupSymbol&) noexcept;
				friend bool operator>(const SpaceGroupSymbol&, const SpaceGroupSymbol&) noexcept;
				friend bool operator==(const SpaceGroupSymbol&, const SpaceGroupSymbol&) noexcept;
				friend bool operator!=(const SpaceGroupSymbol&, const SpaceGroupSymbol&) noexcept;
			};


			inline bool operator<(const SpaceGroupSymbol& sgsa, const SpaceGroupSymbol& sgsb) noexcept
			{
				return (SpaceGroupSymbol::getSpaceGroupNumber(sgsa._symbol) < SpaceGroupSymbol::getSpaceGroupNumber(sgsb._symbol));
			}

			inline bool operator>(const SpaceGroupSymbol& sgsa, const SpaceGroupSymbol& sgsb) noexcept
			{
				return (SpaceGroupSymbol::getSpaceGroupNumber(sgsa._symbol) > SpaceGroupSymbol::getSpaceGroupNumber(sgsb._symbol));
			}

			inline bool operator==(const SpaceGroupSymbol& sgsa, const SpaceGroupSymbol& sgsb) noexcept
			{
				return (SpaceGroupSymbol::getSpaceGroupNumber(sgsa._symbol) == SpaceGroupSymbol::getSpaceGroupNumber(sgsb._symbol));
			}

			inline bool operator!=(const SpaceGroupSymbol& sgsa, const SpaceGroupSymbol& sgsb) noexcept
			{
				return (SpaceGroupSymbol::getSpaceGroupNumber(sgsa._symbol) != SpaceGroupSymbol::getSpaceGroupNumber(sgsb._symbol));
			}
		}
	}
}

// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// Property

inline ChemToolkit::Crystallography::Symmetry::SpaceGroupSymbol::operator std::string() const noexcept
{
	return _symbol;
}

inline void ChemToolkit::Crystallography::Symmetry::SpaceGroupSymbol::set() noexcept
{
	_symbol = std::string{ "P1" };
}

inline void ChemToolkit::Crystallography::Symmetry::SpaceGroupSymbol::set(const std::string& symbol)
{
	_symbol = symbol;

	if (!(isValidSymbol(_symbol)))
		throw System::ExceptionServices::ArgumentOutOfRangeException{ typeid(*this), "set", "Symbol is out of definitions." };
}

// Property
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// Methods

inline std::size_t ChemToolkit::Crystallography::Symmetry::SpaceGroupSymbol::getHashCode() const noexcept
{
	return std::hash<std::string>{}(_symbol);
}

// Methods
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// Private methods

inline bool ChemToolkit::Crystallography::Symmetry::SpaceGroupSymbol::isValidSymbol(const std::string& symbol) noexcept
{
	if (getSpaceGroupNumber(symbol) == 0)
		return false;
	else
		return true;
}

// Private methods
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************


#endif // !CHEMTOOLKIT_CRYSTALLOGRAPHY_SYMMETRY_SPACEGROUPSYMBOL_H
