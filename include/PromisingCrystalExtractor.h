#ifndef MATHEMATICALCRYSTALCHEMISTRY_ANALYSIS_PROMISINGCRYSTALEXTRACTOR_H
#define MATHEMATICALCRYSTALCHEMISTRY_ANALYSIS_PROMISINGCRYSTALEXTRACTOR_H

#include "OptimalCrystalStructure.h"

#include "PromisingCrystalExtractionParameters.h"


namespace MathematicalCrystalChemistry
{
	namespace Analysis
	{
		class PromisingCrystalExtractor
		{
			using size_type = std::size_t;
			using AtomicNumber = ChemToolkit::Generic::AtomicNumber;
			using IonicAtomicNumber = ChemToolkit::Generic::IonicAtomicNumber;

			using OptimalAtom = MathematicalCrystalChemistry::CrystalModel::Components::OptimalAtom;
			using OptimalCrystalStructure = MathematicalCrystalChemistry::CrystalModel::Components::OptimalCrystalStructure;

// **********************************************************************************************************************************************************************************************************************************************************************************************
		// Constructors, destructor, and operators

		public:
			PromisingCrystalExtractor() noexcept;
			explicit PromisingCrystalExtractor(const PromisingCrystalExtractionParameters&) noexcept;

			virtual ~PromisingCrystalExtractor() = default;

			PromisingCrystalExtractor(const PromisingCrystalExtractor&) = default;
			PromisingCrystalExtractor(PromisingCrystalExtractor&&) noexcept = default;
			PromisingCrystalExtractor& operator=(const PromisingCrystalExtractor&) = default;
			PromisingCrystalExtractor& operator=(PromisingCrystalExtractor&&) noexcept = default;

		// Constructors, destructor, and operators
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
		// Property

			const PromisingCrystalExtractionParameters& promisingCrystalExtractionParameters() const noexcept;

			void setPromisingCrystalExtractionParameters(const PromisingCrystalExtractionParameters&) noexcept;

		// Property
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
		// Methods

			bool isPromising(const OptimalCrystalStructure&) const;

		// Methods
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
		// Private methods

		private:
			std::map<IonicAtomicNumber, size_type> countAtomicEnvironments(const OptimalCrystalStructure&) const;

		// Private methods
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
		// Private utility

			bool hasSameAtomicEnvironment(const OptimalAtom&, const OptimalAtom&) const;

		// Private utility
// **********************************************************************************************************************************************************************************************************************************************************************************************

		private:
			PromisingCrystalExtractionParameters _promisingCrystalExtractionParameters;
		};
	}
}

// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// Property

inline const MathematicalCrystalChemistry::Analysis::PromisingCrystalExtractionParameters& MathematicalCrystalChemistry::Analysis::PromisingCrystalExtractor::promisingCrystalExtractionParameters() const noexcept
{
	return _promisingCrystalExtractionParameters;
}

inline void MathematicalCrystalChemistry::Analysis::PromisingCrystalExtractor::setPromisingCrystalExtractionParameters(const PromisingCrystalExtractionParameters& parameters) noexcept
{
	_promisingCrystalExtractionParameters = parameters;
}

// Property
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************


#endif // !MATHEMATICALCRYSTALCHEMISTRY_ANALYSIS_PROMISINGCRYSTALEXTRACTOR_H
