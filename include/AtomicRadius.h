#ifndef MATHEMATICALCRYSTALCHEMISTRY_CRYSTALMODEL_CONSTRAINTS_ATOMICRADIUS_H
#define MATHEMATICALCRYSTALCHEMISTRY_CRYSTALMODEL_CONSTRAINTS_ATOMICRADIUS_H

#include <limits>

#include "ArgumentOutOfRangeException.h"

#include "AtomicNumber.h"
#include "IonicAtomicNumber.h"


namespace MathematicalCrystalChemistry
{
	namespace CrystalModel
	{
		namespace Constraints
		{
			struct atomic_radius_tag
			{
			};

			struct covalent_radius_tag :public atomic_radius_tag
			{
			};

			struct ionic_radius_tag :public atomic_radius_tag
			{
			};

			struct ionic_repulsion_radius_tag :public atomic_radius_tag
			{
			};



			template <typename Category>
			class AtomicRadius
			{
				using charge_type = short;
				using AtomicNumber = ChemToolkit::Generic::AtomicNumber;
				using IonicAtomicNumber = ChemToolkit::Generic::IonicAtomicNumber;

// **********************************************************************************************************************************************************************************************************************************************************************************************
			// Constructors, destructor, and operators

			public:
				AtomicRadius() noexcept;
				explicit AtomicRadius(const IonicAtomicNumber&);
				AtomicRadius(const AtomicNumber, const charge_type);
				AtomicRadius(const double minimum, const double maximum);

				virtual ~AtomicRadius() = default;

				AtomicRadius(const AtomicRadius&) = default;
				AtomicRadius(AtomicRadius&&) noexcept = default;
				AtomicRadius& operator=(const AtomicRadius&) = default;
				AtomicRadius& operator=(AtomicRadius&&) noexcept = default;

			// Constructors, destructor, and operators
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
			// Property

				double minimum() const noexcept;
				double maximum() const noexcept;

				void set() noexcept;
				void set(const double minimumRadius, const double maximumRadius);

			// Property
// **********************************************************************************************************************************************************************************************************************************************************************************************

			private:
				double _minimum;
				double _maximum;
			};



			template <>
			class AtomicRadius<ionic_repulsion_radius_tag>
			{
				using charge_type = short;
				using AtomicNumber = ChemToolkit::Generic::AtomicNumber;
				using IonicAtomicNumber = ChemToolkit::Generic::IonicAtomicNumber;

// **********************************************************************************************************************************************************************************************************************************************************************************************
			// Constructors, destructor, and operators

			public:
				AtomicRadius() noexcept;
				explicit AtomicRadius(const double minimum);
				explicit AtomicRadius(const IonicAtomicNumber&);
				AtomicRadius(const AtomicNumber, const charge_type);

				virtual ~AtomicRadius() = default;

				AtomicRadius(const AtomicRadius&) = default;
				AtomicRadius(AtomicRadius&&) noexcept = default;
				AtomicRadius& operator=(const AtomicRadius&) = default;
				AtomicRadius& operator=(AtomicRadius&&) noexcept = default;

			// Constructors, destructor, and operators
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
			// Property

				double minimum() const noexcept;

				void set() noexcept;
				void set(const double minimumRadius);

			// Property
// **********************************************************************************************************************************************************************************************************************************************************************************************

			private:
				double _minimum;
			};



			using CovalentRadius = AtomicRadius<covalent_radius_tag>;
			using IonicRadius = AtomicRadius<ionic_radius_tag>;
			using IonicRepulsionRadius = AtomicRadius<ionic_repulsion_radius_tag>;
		}
	}
}

// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// Constructors

template <typename Category>
inline MathematicalCrystalChemistry::CrystalModel::Constraints::AtomicRadius<Category>::AtomicRadius() noexcept
	: _minimum{ 0.0 }
	, _maximum{ std::numeric_limits<double>::max() }
{
}

template <typename Category>
inline MathematicalCrystalChemistry::CrystalModel::Constraints::AtomicRadius<Category>::AtomicRadius(const double minimumRadius, const double maximumRadius)
	: _minimum{ 0.0 }
	, _maximum{ std::numeric_limits<double>::max() }
{
	if (minimumRadius < 0.0)
		throw System::ExceptionServices::ArgumentOutOfRangeException{ typeid(*this), "constructor", "Minimum value is negative." };

	else
	{
		if (maximumRadius < 0.0)
			throw System::ExceptionServices::ArgumentOutOfRangeException{ typeid(*this), "constructor", "Maximum value is negative." };

		else
		{
			if (maximumRadius < minimumRadius)
				throw System::ExceptionServices::ArgumentOutOfRangeException{ typeid(*this), "constructor", "Maximum value is less than minimum value." };

			else
			{
				_minimum = minimumRadius;
				_maximum = maximumRadius;
			}
		}
	}
}

// Constructors
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// Property

template <typename Category>
inline double MathematicalCrystalChemistry::CrystalModel::Constraints::AtomicRadius<Category>::minimum() const noexcept
{
	return _minimum;
}

template <typename Category>
inline double MathematicalCrystalChemistry::CrystalModel::Constraints::AtomicRadius<Category>::maximum() const noexcept
{
	return _maximum;
}

template <typename Category>
inline void MathematicalCrystalChemistry::CrystalModel::Constraints::AtomicRadius<Category>::set() noexcept
{
	_minimum = 0.0;
	_maximum = std::numeric_limits<double>::max();
}

template <typename Category>
inline void MathematicalCrystalChemistry::CrystalModel::Constraints::AtomicRadius<Category>::set(const double minimumRadius, const double maximumRadius)
{
	if (minimumRadius < 0.0)
		throw System::ExceptionServices::ArgumentOutOfRangeException{ typeid(*this), "constructor", "Minimum value is negative." };

	else
	{
		if (maximumRadius < 0.0)
			throw System::ExceptionServices::ArgumentOutOfRangeException{ typeid(*this), "constructor", "Maximum value is negative." };

		else
		{
			if (maximumRadius < minimumRadius)
				throw System::ExceptionServices::ArgumentOutOfRangeException{ typeid(*this), "constructor", "Maximum value is less than minimum value." };

			else
			{
				_minimum = minimumRadius;
				_maximum = maximumRadius;
			}
		}
	}
}


inline double MathematicalCrystalChemistry::CrystalModel::Constraints::AtomicRadius<MathematicalCrystalChemistry::CrystalModel::Constraints::ionic_repulsion_radius_tag>::minimum() const noexcept
{
	return _minimum;
}

inline void MathematicalCrystalChemistry::CrystalModel::Constraints::AtomicRadius<MathematicalCrystalChemistry::CrystalModel::Constraints::ionic_repulsion_radius_tag>::set() noexcept
{
	_minimum = 0.0;
}

inline void MathematicalCrystalChemistry::CrystalModel::Constraints::AtomicRadius<MathematicalCrystalChemistry::CrystalModel::Constraints::ionic_repulsion_radius_tag>::set(const double minimumRadius)
{
	if (minimumRadius < 0.0)
		throw System::ExceptionServices::ArgumentOutOfRangeException{ typeid(*this), "set", "Minimum value is negative." };

	else
		_minimum = minimumRadius;
}

// Property
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************


#endif // !MATHEMATICALCRYSTALCHEMISTRY_CRYSTALMODEL_CONSTRAINTS_ATOMICRADIUS_H
