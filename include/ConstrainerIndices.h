#ifndef MATHEMATICALCRYSTALCHEMISTRY_CRYSTALMODEL_COMPONENTS_CONSTRAINERINDICES_H
#define MATHEMATICALCRYSTALCHEMISTRY_CRYSTALMODEL_COMPONENTS_CONSTRAINERINDICES_H

#include "AtomIndex.h"


namespace MathematicalCrystalChemistry
{
	namespace CrystalModel
	{
		namespace Components
		{
			template <typename TA>
			class ConstrainerIndices;



			template <>
			class ConstrainerIndices<ChemToolkit::Crystallography::OriginalAtomIndex> final
			{
				using OriginalAtomIndex = ChemToolkit::Crystallography::OriginalAtomIndex;

			public:
				struct Hasher
				{
					std::size_t operator()(const ConstrainerIndices&) const noexcept;
				};

// **********************************************************************************************************************************************************************************************************************************************************************************************
			// Constructors, destructor, and operators

			public:
				ConstrainerIndices() noexcept;
				ConstrainerIndices(const OriginalAtomIndex, const OriginalAtomIndex) noexcept;

				~ConstrainerIndices() = default;

				ConstrainerIndices(const ConstrainerIndices&) = default;
				ConstrainerIndices(ConstrainerIndices&&) noexcept = default;
				ConstrainerIndices& operator=(const ConstrainerIndices&) = default;
				ConstrainerIndices& operator=(ConstrainerIndices&&) noexcept = default;

			// Constructors, destructor, and operators
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
			// Property

				OriginalAtomIndex originalAtomIndex() const noexcept;
				OriginalAtomIndex translatedAtomIndex() const noexcept;

			// Property
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
			// Methods

				std::size_t getHashCode() const noexcept;

			// Methods
// **********************************************************************************************************************************************************************************************************************************************************************************************

			private:
				OriginalAtomIndex _originalAtomIndex;
				OriginalAtomIndex _translatedAtomIndex;
			};


			template <>
			class ConstrainerIndices<ChemToolkit::Crystallography::TranslatedAtomIndex> final
			{
				using OriginalAtomIndex = ChemToolkit::Crystallography::OriginalAtomIndex;
				using TranslatedAtomIndex = ChemToolkit::Crystallography::TranslatedAtomIndex;

			public:
				struct Hasher
				{
					std::size_t operator()(const ConstrainerIndices&) const noexcept;
				};

// **********************************************************************************************************************************************************************************************************************************************************************************************
			// Constructors, destructor, and operators

			public:
				ConstrainerIndices() noexcept;
				ConstrainerIndices(const OriginalAtomIndex, const TranslatedAtomIndex&) noexcept;
				ConstrainerIndices(const OriginalAtomIndex, TranslatedAtomIndex&&) noexcept;

				~ConstrainerIndices() = default;

				ConstrainerIndices(const ConstrainerIndices&) = default;
				ConstrainerIndices(ConstrainerIndices&&) noexcept = default;
				ConstrainerIndices& operator=(const ConstrainerIndices&) = default;
				ConstrainerIndices& operator=(ConstrainerIndices&&) noexcept = default;

			// Constructors, destructor, and operators
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
			// Property

				OriginalAtomIndex originalAtomIndex() const noexcept;
				const TranslatedAtomIndex& translatedAtomIndex() const noexcept;

			// Property
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
			// Methods

				std::size_t getHashCode() const noexcept;

			// Methods
// **********************************************************************************************************************************************************************************************************************************************************************************************

			private:
				OriginalAtomIndex _originalAtomIndex;
				TranslatedAtomIndex _translatedAtomIndex;
			};



			inline std::size_t ConstrainerIndices<ChemToolkit::Crystallography::OriginalAtomIndex>::Hasher::operator()(const ConstrainerIndices& ci) const noexcept
			{
				return ci.getHashCode();
			}

			inline std::size_t ConstrainerIndices<ChemToolkit::Crystallography::TranslatedAtomIndex>::Hasher::operator()(const ConstrainerIndices& ci) const noexcept
			{
				return ci.getHashCode();
			}

			template <typename T>
			inline bool operator<(const ConstrainerIndices<T>& cia, const ConstrainerIndices<T>& cib) noexcept
			{
				if (cia.originalAtomIndex() < cib.originalAtomIndex())
					return true;

				else if (cib.originalAtomIndex() < cia.originalAtomIndex())
					return false;

				else
				{
					if (cia.translatedAtomIndex() < cib.translatedAtomIndex())
						return true;
					else
						return false;
				}
			}

			template <typename T>
			inline bool operator>(const ConstrainerIndices<T>& cia, const ConstrainerIndices<T>& cib) noexcept
			{
				return (cib < cia);
			}

			template <typename T>
			inline bool operator==(const ConstrainerIndices<T>& cia, const ConstrainerIndices<T>& cib) noexcept
			{
				if (cia.originalAtomIndex() != cib.originalAtomIndex())
					return false;

				if (cia.translatedAtomIndex() != cib.translatedAtomIndex())
					return false;

				return true;
			}

			template <typename T>
			inline bool operator!=(const ConstrainerIndices<T>& cia, const ConstrainerIndices<T>& cib) noexcept
			{
				return !(cia == cib);
			}
		}
	}
}

// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// Constructors

inline MathematicalCrystalChemistry::CrystalModel::Components::ConstrainerIndices<ChemToolkit::Crystallography::OriginalAtomIndex>::ConstrainerIndices() noexcept
	: _originalAtomIndex{}
	, _translatedAtomIndex{}
{
}

inline MathematicalCrystalChemistry::CrystalModel::Components::ConstrainerIndices<ChemToolkit::Crystallography::OriginalAtomIndex>::ConstrainerIndices(const OriginalAtomIndex oai, const OriginalAtomIndex tai) noexcept
	: _originalAtomIndex{ oai }
	, _translatedAtomIndex{ tai }
{
}

inline MathematicalCrystalChemistry::CrystalModel::Components::ConstrainerIndices<ChemToolkit::Crystallography::TranslatedAtomIndex>::ConstrainerIndices() noexcept
	: _originalAtomIndex{}
	, _translatedAtomIndex{}
{
}

inline MathematicalCrystalChemistry::CrystalModel::Components::ConstrainerIndices<ChemToolkit::Crystallography::TranslatedAtomIndex>::ConstrainerIndices(const OriginalAtomIndex oai, const TranslatedAtomIndex& tai) noexcept
	: _originalAtomIndex{ oai }
	, _translatedAtomIndex{ tai }
{
}

inline MathematicalCrystalChemistry::CrystalModel::Components::ConstrainerIndices<ChemToolkit::Crystallography::TranslatedAtomIndex>::ConstrainerIndices(const OriginalAtomIndex oai, TranslatedAtomIndex&& tai) noexcept
	: _originalAtomIndex{ oai }
	, _translatedAtomIndex{ std::move(tai) }
{
}

// Constructors
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// Property

inline MathematicalCrystalChemistry::CrystalModel::Components::ConstrainerIndices<ChemToolkit::Crystallography::OriginalAtomIndex>::OriginalAtomIndex MathematicalCrystalChemistry::CrystalModel::Components::ConstrainerIndices<ChemToolkit::Crystallography::OriginalAtomIndex>::originalAtomIndex() const noexcept
{
	return _originalAtomIndex;
}

inline MathematicalCrystalChemistry::CrystalModel::Components::ConstrainerIndices<ChemToolkit::Crystallography::OriginalAtomIndex>::OriginalAtomIndex MathematicalCrystalChemistry::CrystalModel::Components::ConstrainerIndices<ChemToolkit::Crystallography::OriginalAtomIndex>::translatedAtomIndex() const noexcept
{
	return _translatedAtomIndex;
}

inline MathematicalCrystalChemistry::CrystalModel::Components::ConstrainerIndices<ChemToolkit::Crystallography::TranslatedAtomIndex>::OriginalAtomIndex MathematicalCrystalChemistry::CrystalModel::Components::ConstrainerIndices<ChemToolkit::Crystallography::TranslatedAtomIndex>::originalAtomIndex() const noexcept
{
	return _originalAtomIndex;
}

inline const MathematicalCrystalChemistry::CrystalModel::Components::ConstrainerIndices<ChemToolkit::Crystallography::TranslatedAtomIndex>::TranslatedAtomIndex& MathematicalCrystalChemistry::CrystalModel::Components::ConstrainerIndices<ChemToolkit::Crystallography::TranslatedAtomIndex>::translatedAtomIndex() const noexcept
{
	return _translatedAtomIndex;
}

// Property
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// Methods

inline std::size_t MathematicalCrystalChemistry::CrystalModel::Components::ConstrainerIndices<ChemToolkit::Crystallography::OriginalAtomIndex>::getHashCode() const noexcept
{
	return (std::hash<OriginalAtomIndex>{}(_originalAtomIndex) ^ std::hash<OriginalAtomIndex>{}(_translatedAtomIndex));
}

inline std::size_t MathematicalCrystalChemistry::CrystalModel::Components::ConstrainerIndices<ChemToolkit::Crystallography::TranslatedAtomIndex>::getHashCode() const noexcept
{
	return (std::hash<OriginalAtomIndex>{}(_originalAtomIndex) ^ _translatedAtomIndex.getHashCode());
}

// Methods
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************


#endif // !MATHEMATICALCRYSTALCHEMISTRY_CRYSTALMODEL_COMPONENTS_CONSTRAINERINDICES_H
