#ifndef CHEMTOOLKIT_CRYSTALLOGRAPHY_SYMMETRY_WYCKOFFSYMBOL_H
#define CHEMTOOLKIT_CRYSTALLOGRAPHY_SYMMETRY_WYCKOFFSYMBOL_H

#include <string>
#include <functional>

#include "ArgumentOutOfRangeException.h"
#include "MemberAccessException.h"


namespace ChemToolkit
{
	namespace Crystallography
	{
		namespace Symmetry
		{
			class WyckoffSymbol
			{
				using size_type = unsigned short;

// **********************************************************************************************************************************************************************************************************************************************************************************************
			// Constructors, destructor, and operators

			public:
				WyckoffSymbol() noexcept;
				WyckoffSymbol(const std::string&);

				explicit WyckoffSymbol(const size_type);
				explicit WyckoffSymbol(const std::size_t);
				explicit WyckoffSymbol(const int);

				virtual ~WyckoffSymbol() = default;

				WyckoffSymbol(const WyckoffSymbol&) = default;
				WyckoffSymbol(WyckoffSymbol&&) noexcept = default;
				WyckoffSymbol& operator=(const WyckoffSymbol&) = default;
				WyckoffSymbol& operator=(WyckoffSymbol&&) noexcept = default;

			// Constructors, destructor, and operators
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
			// Property

				operator std::string() const;

				void set() noexcept;
				void set(const std::string);

			// Property
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
			// Methods

				bool isValid() const noexcept;
				std::size_t getHashCode() const noexcept;

			// Methods
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
			// Private methods

			private:
				static bool isValidSymbol(const std::string&) noexcept;
				static std::string toSymbol(const size_type);

			// Private methods
// **********************************************************************************************************************************************************************************************************************************************************************************************

			private:
				std::string _symbol;


				friend bool operator<(const WyckoffSymbol&, const WyckoffSymbol&) noexcept;
				friend bool operator>(const WyckoffSymbol&, const WyckoffSymbol&) noexcept;
				friend bool operator==(const WyckoffSymbol&, const WyckoffSymbol&) noexcept;
				friend bool operator!=(const WyckoffSymbol&, const WyckoffSymbol&) noexcept;
			};


			inline bool operator<(const WyckoffSymbol& wsa, const WyckoffSymbol& wsb) noexcept
			{
				return (wsa._symbol < wsb._symbol);
			}

			inline bool operator>(const WyckoffSymbol& wsa, const WyckoffSymbol& wsb) noexcept
			{
				return (wsa._symbol > wsb._symbol);
			}

			inline bool operator==(const WyckoffSymbol& wsa, const WyckoffSymbol& wsb) noexcept
			{
				return (wsa._symbol == wsb._symbol);
			}

			inline bool operator!=(const WyckoffSymbol& wsa, const WyckoffSymbol& wsb) noexcept
			{
				return (wsa._symbol != wsb._symbol);
			}
		}
	}
}

// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// Property

inline ChemToolkit::Crystallography::Symmetry::WyckoffSymbol::operator std::string() const
{
	if (_symbol.empty())
		throw System::ExceptionServices::MemberAccessException{ typeid(*this), "operator", "Symbol is empty." };
	else
		return _symbol;
}

inline void ChemToolkit::Crystallography::Symmetry::WyckoffSymbol::set() noexcept
{
	_symbol.clear();
}

inline void ChemToolkit::Crystallography::Symmetry::WyckoffSymbol::set(const std::string symbol)
{
	_symbol = symbol;

	if (!(isValidSymbol(_symbol)))
		throw System::ExceptionServices::ArgumentOutOfRangeException{ typeid(*this), "set", "Wyckoff symbol is invalid." };
}

// Property
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// Methods

inline bool ChemToolkit::Crystallography::Symmetry::WyckoffSymbol::isValid() const noexcept
{
	return !(_symbol.empty());
}

inline std::size_t ChemToolkit::Crystallography::Symmetry::WyckoffSymbol::getHashCode() const noexcept
{
	return std::hash<std::string>{}(_symbol);
}

// Methods
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************

#endif // !CHEMTOOLKIT_CRYSTALLOGRAPHY_SYMMETRY_WYCKOFFSYMBOL_H
