#ifndef CHEMTOOLKIT_GENERIC_IONICATOMICNUMBER_H
#define CHEMTOOLKIT_GENERIC_IONICATOMICNUMBER_H


#include <cmath>
#include <functional>
#include <string>

#include "AtomicNumber.h"
#include "FormalCharge.h"


namespace ChemToolkit
{
	namespace Generic
	{
		class IonicAtomicNumber
		{
		public:
			using size_type = unsigned short;


// **********************************************************************************************************************************************************************************************************************************************************************************************
		// Constructors, destructor, and operators

		public:
			IonicAtomicNumber() noexcept;
			IonicAtomicNumber(const AtomicNumber, const FormalCharge);

			virtual ~IonicAtomicNumber() = default;

			IonicAtomicNumber(const IonicAtomicNumber&) = default;
			IonicAtomicNumber(IonicAtomicNumber&&) noexcept = default;
			IonicAtomicNumber& operator=(const IonicAtomicNumber&) = default;
			IonicAtomicNumber& operator=(IonicAtomicNumber&&) noexcept = default;

		// Constructors, destructor, and operators
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
		// Property

			AtomicNumber atomicNumber() const noexcept;
			FormalCharge formalCharge() const noexcept;

		// Property
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
		// Methods

			std::size_t getHashCode() const;
			std::string toHashString() const;

			std::string toString() const noexcept;

			static IonicAtomicNumber toIonicAtomicNumber(const std::string&);

		// Methods
// **********************************************************************************************************************************************************************************************************************************************************************************************

		private:
			AtomicNumber _atomicNumber;
			FormalCharge _formalCharge;
		};


		inline bool operator<(const IonicAtomicNumber& iana, const IonicAtomicNumber& ianb) noexcept
		{
			if (iana.atomicNumber() < ianb.atomicNumber())
				return true;

			else if (iana.atomicNumber() > ianb.atomicNumber())
				return false;

			else
			{
				if (iana.formalCharge() < ianb.formalCharge())
					return true;

				else
					return false;
			}
		}

		inline bool operator>(const IonicAtomicNumber& iana, const IonicAtomicNumber& ianb) noexcept
		{
			return (ianb < iana);
		}

		inline bool operator==(const IonicAtomicNumber& iana, const IonicAtomicNumber& ianb) noexcept
		{
			return ((iana.atomicNumber() == ianb.atomicNumber()) && (iana.formalCharge() == ianb.formalCharge()));
		}

		inline bool operator!=(const IonicAtomicNumber& iana, const IonicAtomicNumber& ianb) noexcept
		{
			return !(iana == ianb);
		}
	}
}

// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// Constructors

inline ChemToolkit::Generic::IonicAtomicNumber::IonicAtomicNumber() noexcept
	: _atomicNumber{}
	, _formalCharge{ 0 }
{
}

inline ChemToolkit::Generic::IonicAtomicNumber::IonicAtomicNumber(const AtomicNumber an, const FormalCharge charge)
	: _atomicNumber{ an }
	, _formalCharge{ charge }
{
}

// Constructors
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// Property

inline ChemToolkit::Generic::AtomicNumber ChemToolkit::Generic::IonicAtomicNumber::atomicNumber() const noexcept
{
	return _atomicNumber;
}

inline ChemToolkit::Generic::FormalCharge ChemToolkit::Generic::IonicAtomicNumber::formalCharge() const noexcept
{
	return _formalCharge;
}

// Property
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// Methods

inline std::size_t ChemToolkit::Generic::IonicAtomicNumber::getHashCode() const
{
	return (_atomicNumber.getHashCode() ^ _formalCharge.getHashCode());
}

inline std::string ChemToolkit::Generic::IonicAtomicNumber::toHashString() const
{
	std::string hashString = _atomicNumber.toHashString();
	{
		hashString += "_";
		hashString += std::to_string(formalCharge());
	}

	return hashString;
}

inline std::string ChemToolkit::Generic::IonicAtomicNumber::toString() const noexcept
{
	std::string name;
	name += _atomicNumber.toElementSymbol();
	{
		if (_formalCharge.isCation())
		{
			name += std::to_string(_formalCharge);
			name += "+";
		}

		else
		{
			if (_formalCharge.isAnion())
			{
				name += std::to_string(std::abs(_formalCharge));
				name += "-";
			}
		}
	}

	return name;
}

// Private methods
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************


#endif // !CHEMTOOLKIT_GENERIC_IONICATOMICNUMBER_H
