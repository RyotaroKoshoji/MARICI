#ifndef MATHEMATICALCRYSTALCHEMISTRY_CRYSTALMODEL_COMPONENTS_SPHERICALATOM_H
#define MATHEMATICALCRYSTALCHEMISTRY_CRYSTALMODEL_COMPONENTS_SPHERICALATOM_H

#include <cmath>

#include "NumericalVector.h"
#include "AtomicNumber.h"

#include "AtomicRadius.h"


namespace MathematicalCrystalChemistry
{
	namespace CrystalModel
	{
		namespace Components
		{
			class ConstrainingAtom;


			class SphericalAtom final
			{
				using charge_type = short;
				using AtomicNumber = ChemToolkit::Generic::AtomicNumber;
				using NumericalVector = MathToolkit::LinearAlgebra::NumericalVector<double, 3>;

				using CovalentRadius = MathematicalCrystalChemistry::CrystalModel::Constraints::CovalentRadius;
				using IonicRadius = MathematicalCrystalChemistry::CrystalModel::Constraints::IonicRadius;
				using IonicRepulsionRadius = MathematicalCrystalChemistry::CrystalModel::Constraints::IonicRepulsionRadius;

// **********************************************************************************************************************************************************************************************************************************************************************************************
			// Constructors, destructor, and operators

			public:
				SphericalAtom() noexcept;
				explicit SphericalAtom(const NumericalVector&) noexcept;
				SphericalAtom(const AtomicNumber, const charge_type);
				SphericalAtom(const AtomicNumber, const charge_type, const NumericalVector&);

				explicit SphericalAtom(const ConstrainingAtom&) noexcept;

				~SphericalAtom() = default;

				SphericalAtom(const SphericalAtom&) = default;
				SphericalAtom(SphericalAtom&&) noexcept = default;
				SphericalAtom& operator=(const SphericalAtom&) = default;
				SphericalAtom& operator=(SphericalAtom&&) noexcept = default;

			// Constructors, destructor, and operators
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
			// Property

				const NumericalVector& cartesianCoordinate() const noexcept;
				NumericalVector& cartesianCoordinate() noexcept;

				const NumericalVector& appliedForce() const noexcept;
				NumericalVector& appliedForce() noexcept;

				const CovalentRadius& covalentRadius() const noexcept;
				const IonicRadius& ionicRadius() const noexcept;
				const IonicRepulsionRadius& ionicRepulsionRadius() const noexcept;

				void setCovalentRadius(const CovalentRadius&) noexcept;
				void setIonicRadius(const IonicRadius&) noexcept;
				void setIonicRepulsionRadius(const IonicRepulsionRadius&) noexcept;

			// Property
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
			// Methods

				void move(const double maxDisplacement) noexcept;

			// Methods
// **********************************************************************************************************************************************************************************************************************************************************************************************

			private:
				NumericalVector _cartesianCoordinate;
				NumericalVector _appliedForce;

				CovalentRadius _covalentRadius;
				IonicRadius _ionicRadius;
				IonicRepulsionRadius _ionicRepulsionRadius;
			};
		}
	}
}

// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// Property

inline const MathematicalCrystalChemistry::CrystalModel::Components::SphericalAtom::NumericalVector& MathematicalCrystalChemistry::CrystalModel::Components::SphericalAtom::cartesianCoordinate() const noexcept
{
	return _cartesianCoordinate;
}

inline MathematicalCrystalChemistry::CrystalModel::Components::SphericalAtom::NumericalVector& MathematicalCrystalChemistry::CrystalModel::Components::SphericalAtom::cartesianCoordinate() noexcept
{
	return _cartesianCoordinate;
}

inline const MathematicalCrystalChemistry::CrystalModel::Components::SphericalAtom::NumericalVector& MathematicalCrystalChemistry::CrystalModel::Components::SphericalAtom::appliedForce() const noexcept
{
	return _appliedForce;
}

inline MathematicalCrystalChemistry::CrystalModel::Components::SphericalAtom::NumericalVector& MathematicalCrystalChemistry::CrystalModel::Components::SphericalAtom::appliedForce() noexcept
{
	return _appliedForce;
}

inline const MathematicalCrystalChemistry::CrystalModel::Components::SphericalAtom::CovalentRadius& MathematicalCrystalChemistry::CrystalModel::Components::SphericalAtom::covalentRadius() const noexcept
{
	return _covalentRadius;
}

inline const MathematicalCrystalChemistry::CrystalModel::Components::SphericalAtom::IonicRadius& MathematicalCrystalChemistry::CrystalModel::Components::SphericalAtom::ionicRadius() const noexcept
{
	return _ionicRadius;
}

inline const MathematicalCrystalChemistry::CrystalModel::Components::SphericalAtom::IonicRepulsionRadius& MathematicalCrystalChemistry::CrystalModel::Components::SphericalAtom::ionicRepulsionRadius() const noexcept
{
	return _ionicRepulsionRadius;
}

inline void MathematicalCrystalChemistry::CrystalModel::Components::SphericalAtom::setCovalentRadius(const CovalentRadius& radius) noexcept
{
	_covalentRadius = radius;
}

inline void MathematicalCrystalChemistry::CrystalModel::Components::SphericalAtom::setIonicRadius(const IonicRadius& radius) noexcept
{
	_ionicRadius = radius;
}

inline void MathematicalCrystalChemistry::CrystalModel::Components::SphericalAtom::setIonicRepulsionRadius(const IonicRepulsionRadius& radius) noexcept
{
	_ionicRepulsionRadius = radius;
}

// Property
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// Methods

inline void MathematicalCrystalChemistry::CrystalModel::Components::SphericalAtom::move(const double maxDisplacement) noexcept
{
	double forceNormSquare = _appliedForce.normSquare();
	{
		if ((maxDisplacement * maxDisplacement) < forceNormSquare)
		{
			double forceNorm = std::sqrt(forceNormSquare);
			_appliedForce *= (maxDisplacement / forceNorm);
		}
	}

	_cartesianCoordinate += _appliedForce;
	_appliedForce = 0.0;
}

// Methods
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************


#endif // !MATHEMATICALCRYSTALCHEMISTRY_CRYSTALMODEL_COMPONENTS_SPHERICALATOM_H
