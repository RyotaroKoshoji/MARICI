#ifndef SYSTEM_IO_FILESTREAM_H
#define SYSTEM_IO_FILESTREAM_H

#include <string>
#include <filesystem>

#include "InvalidOperationException.h"
#include "FileNotFoundException.h"

#include "File.h"


namespace System
{
	namespace IO
	{
		class FileStream
		{
		public:
			enum class FileMode
			{
				append,
				create,
				createNew,
				openRead,
			};

// **********************************************************************************************************************************************************************************************************************************************************************************************
		// Constructors, destructor, and operators

		public:
			FileStream() noexcept;
			FileStream(const std::filesystem::path&, const FileMode&);
			virtual ~FileStream() = default;

			FileStream(const FileStream&) = default;
			FileStream(FileStream&&) noexcept = default;
			FileStream& operator=(const FileStream&) = default;
			FileStream& operator=(FileStream&&) noexcept = default;

		// Constructors, destructor, and operators
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
		// Properties

			const std::filesystem::path& filePath() const noexcept;
			const FileMode& fileMode() const noexcept;

			void set(const std::filesystem::path&, const FileMode&);

		// Properties
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
		// Methods

			virtual bool canRead() const;
			virtual bool canWrite() const;

			std::vector<std::string> readAllLines() const;
			std::string readAllTexts() const;

			void write(const std::vector<std::string>&) const;
			void write(const std::string&) const;

			virtual void release();

		// Methods
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
		// Protected methods

		protected:
			void setExistingFilePath(const std::filesystem::path&, const FileMode&);

		// Protected methods
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
		// Private methods

		private:
			void validateFilePath() const;
			void validateReadable() const;
			void validateWritable() const;

		// Private methods
// **********************************************************************************************************************************************************************************************************************************************************************************************

		private:
			std::filesystem::path _filePath;
			FileMode _fileMode;
		};
	}
}

// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// Properties

inline const std::filesystem::path& System::IO::FileStream::filePath() const noexcept
{
	return _filePath;
}

inline const System::IO::FileStream::FileMode& System::IO::FileStream::fileMode() const noexcept
{
	return _fileMode;
}

// Properties
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// Methods

inline bool System::IO::FileStream::canRead() const
{
	if (_fileMode == FileMode::openRead)
		return System::IO::File::exist(_filePath);
	else
		return false;
}

inline bool System::IO::FileStream::canWrite() const
{
	if ((_fileMode == FileMode::append) || (_fileMode == FileMode::create) || (_fileMode == FileMode::createNew))
		return System::IO::File::exist(_filePath);
	else
		return false;
}

inline void System::IO::FileStream::release()
{
	_filePath.clear();
	_fileMode = FileMode::openRead;
}

// Methods
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// Protected methods

inline void System::IO::FileStream::setExistingFilePath(const std::filesystem::path& existingFilePath, const FileMode& mode)
{
	_filePath = existingFilePath;
	_fileMode = mode;
}

// Protected methods
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************
// **********************************************************************************************************************************************************************************************************************************************************************************************


#endif // !SYSTEM_IO_FILESTREAM_H
